<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AdPay</title>
<link rel="stylesheet" href="<%=request.getContextPath()%>/css/header.css">
<link rel="stylesheet" href="<%=request.getContextPath()%>/css/top.css">

<!-- ファビコン -->
<link rel="icon" href="<%=request.getContextPath()%>/images/adpay.ico" type="image/x-icon">
<link rel="shortcut icon" href="<%=request.getContextPath()%>/images/adpay.ico" type="image/x-icon">

</head>
<body>
  <header>
    <!-- ▼ ロゴをクリックしたらホーム（動的リンク対応） -->
    <%
        String role = (String) session.getAttribute("role");
        String homeUrl;
        if ("admin".equals(role)) {
            homeUrl = request.getContextPath() + "/Adpay/Login.action";
        } else if ("store".equals(role)) {
            homeUrl = request.getContextPath() + "/Adpay/StoreLogin.action";
        } else if ("user".equals(role)) {
            homeUrl = request.getContextPath() + "/user/hoge.jsp";
        } else if ("group".equals(role)) {
            homeUrl = request.getContextPath() + "/user/group/hoge.jsp";
        } else {
            homeUrl = request.getContextPath() + "/Adpay/login.jsp";
        }
    %>

    <a href="<%= homeUrl %>">
      <img src="<%=request.getContextPath()%>/images/adpay.png" alt="サービス画像">
    </a>

    <!-- ▼ ナビゲーション -->
<nav>
  <ul>
    <!-- 動的ホームリンク -->
    <li><a href="<%= homeUrl %>">ホーム</a></li>

    <!-- サービスメニュー -->
    <li class="dropdown">
      <a href="#" class="dropdown-toggle">サービス</a>
      <div class="mega-menu">
        <div class="mega-left"></div>
        <div class="mega-right">
          <h2>広告サービス</h2>
          <ul>
            <li><a href="#">デジタル広告</a></li>
            <li><a href="#">リターゲティング</a></li>
            <li><a href="#">SNSプロモーション</a></li>
          </ul>
          <h2>サポート</h2>
          <ul>
            <li><a href="#">導入ガイド</a></li>
            <li><a href="#">FAQ</a></li>
            <li><a href="#">お問い合わせ</a></li>
          </ul>
        </div>
      </div>
    </li>

    <li><a href="#">料金プラン</a></li>

    <%-- ▼ 未ログイン時のみ「管理者ログイン」を表示 --%>
    <% if (role == null) { %>
      <li><a href="<%=request.getContextPath()%>/admin/login_admin.jsp">管理者ログイン</a></li>
    <% } %>

    <%-- ▼ ログイン中のみ「ログアウト」を表示 --%>
    <% if (role != null) { %>
      <li><a href="<%= request.getContextPath() %>/Adpay/Logout.action">ログアウト</a></li>
    <% } %>
  </ul>
</nav>
  </header>

  <!-- ▼ メニュー制御スクリプト -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const dropdown = document.querySelector(".dropdown");
      const toggle = dropdown.querySelector(".dropdown-toggle");
      const menu = dropdown.querySelector(".mega-menu");

      toggle.addEventListener("click", (e) => {
        e.preventDefault();
        menu.classList.toggle("show");
        toggle.classList.toggle("active");
      });

      // 他をクリックしたら閉じる
      document.addEventListener("click", (e) => {
        if (!dropdown.contains(e.target)) {
          menu.classList.remove("show");
          toggle.classList.remove("active");
        }
      });
    });
  </script>
</body>
</html>
