	<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AdPay</title>
<link rel="stylesheet" href="<%=request.getContextPath()%>/css/header.css">

<!-- ファビコン -->
<link rel="icon" href="<%=request.getContextPath()%>/images/adpay.ico" type="image/x-icon">
<link rel="shortcut icon" href="<%=request.getContextPath()%>/images/adpay.ico" type="image/x-icon">
</head>
<body>
  <header>
    <!-- ▼ ロゴをクリックしたらホーム（動的リンク対応） -->
    <%
        String role = (String) session.getAttribute("role");
        String homeUrl;

        if ("admin".equals(role)) {
            homeUrl = request.getContextPath() + "/Adpay/AdminLogin.action";
        } else if ("store".equals(role)) {
            homeUrl = request.getContextPath() + "/Adpay/StoreLogin.action";
        } else if ("user".equals(role)) {
            // ✅ ユーザーはログイン後ページへ（.action 経由）
            homeUrl = request.getContextPath() + "/Adpay/UserLogin.action";
        } else if ("group".equals(role)) {
            homeUrl = request.getContextPath() + "/Adpay/GroupLogin.action";
        } else {
            // 未ログイン時はトップページ
            homeUrl = request.getContextPath() + "/Adpay/login.jsp";
        }
    %>

    <a href="<%= homeUrl %>">
      <img src="<%=request.getContextPath()%>/images/adpay.png" alt="サービス画像">
    </a>

    <!-- ▼ ナビゲーション -->
    <nav>
      <ul>


        <%-- ▼ 未ログイン時のみ「管理者ログイン」を表示 --%>
        <% if (role == null) { %>
          <li><a href="<%=request.getContextPath()%>/admin/login_admin.jsp">管理者ログイン</a></li>
        <% } %>

        <%-- ▼ ログイン中のみ「ログアウト」を表示 --%>
        <% if (role != null) { %>
          <li><a href="<%= request.getContextPath() %>/Adpay/Logout.action">ログアウト</a></li>
        <% } %>
      </ul>
    </nav>
  </header>

  <!-- ▼ メニュー制御スクリプト -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const dropdown = document.querySelector(".dropdown");
      const toggle = dropdown.querySelector(".dropdown-toggle");
      const menu = dropdown.querySelector(".mega-menu");

      toggle.addEventListener("click", (e) => {
        e.preventDefault();
        menu.classList.toggle("show");
        toggle.classList.toggle("active");
      });

      // 他をクリックしたら閉じる
      document.addEventListener("click", (e) => {
        if (!dropdown.contains(e.target)) {
          menu.classList.remove("show");
          toggle.classList.remove("active");
        }
      });
    });
  </script>
